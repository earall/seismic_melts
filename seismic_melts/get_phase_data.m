function [M, rho, CS] = get_phase_data(phase)
%GET_PHASE_DATA Gives elastic stifness matrix and density for 'phase' in
%database
% 
%   The get_phase_data function contains a database of elastic stiffness 
%   matrices and densities for the individual phases. 
%   If the phase is not present in the database, an error message will be 
%   displayed and the code will fail.
% 
% 
%   INPUT
%   phase - specified mineral phase
%   
%   OUTPUT
%   M - Elastic stiffness matrix (GPa)
%   rho - Density (g/m^3)
% 	CS - Crystal symmetry
%
%   Minerals present:
%   Almandine				Biotite				KFeldspar
%   An0-10 Albite			Calcite				Muscovite
%   An25 Oligoclase			Chlorite			Pyrope
%   An38 Andesine			Diopside			Quartz
%   An67 Labradorite		Enstatite			Rutile
%   An85 Bytownite			Epidote				Scapolite
%   An90-100 Anorthosite	Forsterite			Sillimanite
%   Andalusite				Hornblende			Staurolite
%   Apatite					Hypersthene			Tourmaline
%   Augite					Ilmenite		
%
%	Add new phases using the format defined here
%
%   If phase not present in database - 'ERROR'
%
%   Please direct all questions to A. L. Lee
%	Copyright (c) 2019 Amicia Lee, see LICENSE
%
%% ***********************************************************************
%
    if (strcmp(phase, 'Almandine'))
        M = [[ 287.4  105.0  105.0  0.000  0.000  0.000];...
            [ 105.0  287.4  105.0  0.000  0.000  0.000];...
            [ 105.0  105.0  287.4  0.000  0.000  0.000];...
            [ 0.000  0.000  0.000  91.60  0.000  0.000];...
            [ 0.000  0.000  0.000  0.000  91.60  0.000];...
            [ 0.000  0.000  0.000  0.000  0.000  91.60]];

       rho = 3.58;
        
        CS =  crystalSymmetry('m-3m', [11.531 11.531 11.531],...
            'mineral', 'Almandine', 'color', 'magenta');

    elseif (strcmp(phase, 'An0-10 Alb'))
       M = [[130.7  25.12  42.70  -9.72  -2.68  -1.35];...
            [25.12  69.18  33.70  0.360  00.50  00.08];...
            [42.70  33.70  143.7  05.10  03.59  01.30];...
            [-9.27  00.36  05.10  23.95  01.41  -0.26];...
            [-2.68  00.50  03.59  01.41  22.62  -7.25];...
            [-1.65  00.08  01.30  -0.26  -7.25  27.05]];
        
       rho = 2.62;
       
       CS =  crystalSymmetry('-1', [8.161 12.875 7.11],...
        [93.53,116.46,90.24]*degree, 'X||a*', 'Z||c', 'mineral',...
        'An0-10 Alb', 'color', 'blue');
        
    elseif (strcmp(phase, 'An25 Olig'))
       
       M = [[91.66  36.61  36.14  00.84  -0.86  -0.19];...
            [36.61  95.44  36.75  01.23  -0.83  -0.60];...
            [36.14  36.75  92.85  01.74  -1.29  00.20];...
            [00.84  01.23  01.74  28.08  -0.13  -0.09];...
            [-0.86  -0.83  -1.29  -0.13  27.92  00.42];...
            [-0.19  -0.60  00.20  -0.09  00.42  27.98]];

       rho = 2.65;
       
       CS =  crystalSymmetry('-1', [8.169 12.851 7.124],...
        [93.63,116.4,89.46]*degree, 'X||a*', 'Z||c', 'mineral',...
        'An25 Olig', 'color', 'blue');
       
    elseif (strcmp(phase, 'An38 And'))
       M = [[ 96.20  46.10  38.40  05.90  -0.20  -00.4];...
            [ 46.10  189.4  15.40  -07.0  -5.10  -06.8];...
            [ 38.40  15.40  171.9  02.20  7.200  -09.8];...
            [ 05.90  -7.00  2.200  23.60  -1.10  -04.8];...
            [ -0.20  -5.10  7.200  -01.1  33.10  01.40];...
            [ -0.40  -6.80  -09.8  -04.8  1.400  35.50]];
        
        rho = 2.56;
        
        CS = crystalSymmetry('-1', [8.151 12.829 7.103],...
        [93.62,116.21,89.7]*degree, 'X||a*', 'Z||c', 'mineral',...
        'An38 And', 'color', 'blue');

    elseif (strcmp(phase, 'An67 Lab'))
       M = [[99.40  62.80  48.70  0.000  -2.50  0.000];...
            [62.80  158.0  26.70  0.000  -10.7  0.000];...
            [48.70  26.70  150.0  0.000  -12.4  0.000];...
            [0.000  0.000  0.000  21.70  0.000  -5.40];...
            [-2.50  -10.7  -12.4  0.000  34.50  0.000];...
            [0.000  0.000  0.000  -5.40  0.000  37.10]];

       rho = 2.72;
       
       CS = crystalSymmetry('-1', [8.17 12.86 7.11],...
        [93.6,116.3,89.8]*degree, 'X||a*', 'Z||c', 'mineral',...
        'An67 Lab', 'color', 'blue');
       
    elseif (strcmp(phase, 'An85 Byt'))
       M = [[120.40  56.60  49.90  09.00  03.20 -3.000];...
            [ 56.60  91.60  26.30  02.10  05.40 -9.900];...
            [ 49.90  26.30 163.70  01.70  01.70 -8.100];...
            [ 09.00  02.10  01.70  23.30  0.800  0.900];...
            [ 03.20  05.40  01.70  0.800  32.80  4.500];...
            [-03.00 -09.90 -08.10  0.900  04.50  35.00]];

       rho = 2.73;
       
       CS = crystalSymmetry('-1', [8.188 12.882 14.196],...
        [93.37,116.04,90.87]*degree, 'X||a*', 'Z||c', 'mineral',...
        'An85 Byt', 'color', 'blue');
       
    elseif (strcmp(phase, 'An90-100 Ano'))
       M = [[124.0  66.00  50.00  0.000  -19.0  0.000];...
            [66.00  205.0  42.00  0.000  -7.00  0.000];...
            [50.00  42.00  156.0  0.000  -18.0  0.000];...
            [0.000  0.000  0.000  23.50  0.000  -1.00];...
            [-19.0  -7.00  -18.0  0.000  40.40  0.000];...
            [0.000  0.000  0.000  -1.00  0.000  41.50]];
       
       rho = 2.76;
       
       CS = crystalSymmetry('-1', [8.173 12.869 14.165],...
        [93.11,115.91,91.261]*degree, 'X||a*', 'Z||c', 'mineral',...
        'An90-100 Ano', 'color', 'blue');
    
    elseif (strcmp(phase, 'Andalusite'))
       M = [[233.4  97.70  116.2  0.000  0.000  0.000];...
            [97.70  289.0  81.40  0.000  0.000  0.000];...
            [116.2  81.40  380.1  0.000  0.000  0.000];...
            [0.000  0.000  0.000  99.50  0.000  0.000];...
            [0.000  0.000  0.000  0.000  87.80  0.000];...
            [0.000  0.000  0.000  0.000  0.000  112.3]];

       rho = 3.15;
       
       CS =  crystalSymmetry('2/m', [7.798 7.9031 5.5566],...
        [90,90,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Andalusite', 'color', 'light blue');
    
    elseif (strcmp(phase, 'Apatite'))
       M = [[161.55	42.51	42.51	0	0	0];...
            [42.51	161.55	42.51	0	0	0];...
            [42.51	42.51	161.55	0	0	0];...
            [0	0	0	59.52	0	0];...
            [0	0	0	0	59.52	0];...
            [0	0	0	0	0	59.52]];
       
       rho = 4.34;
       
       CS =  crystalSymmetry('6/m', [9.3995 9.3995 6.8941], ...
           'X||a*', 'Y||b', 'Z||c', 'mineral', 'Apatite', 'color', 'light blue');

    elseif (strcmp(phase, 'Augite'))
        M = [[181.6  73.40  72.40  0.000  19.90  0.000];...
             [73.40  150.7  33.90  0.000  16.60  0.000];...
             [72.40  33.90  217.8  0.000  24.60  0.000];...
             [0.000  0.000  0.000  69.70  0.000  04.30];...
             [19.90  16.60  24.60  0.000  51.10  0.000];...
             [0.000  0.000  0.000  04.30  0.000  55.80]];

       rho = 3.4;
       
       CS = crystalSymmetry('12/m1', [9.707 8.858 5.274],...
        [90,106.52,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Augite', 'color', 'dark blue');
       
    elseif (strcmp(phase, 'Biotite'))
       M = [[ 186.0  32.40  11.60  0.000  0.000  0.000];...
            [ 32.40  186.0  11.60  0.000  0.000  0.000];...
            [ 11.60  11.60  54.60  0.000  0.000  0.000];...
            [ 0.000  0.000  0.000  5.860  0.000  0.000];...
            [ 0.000  0.000  0.000  0.000  5.800  0.000];...
            [ 0.000  0.000  0.000  0.000  0.000  76.80]];

       rho = 3.06;
       
       CS =  crystalSymmetry('12/m1', [5.3570  9.2450 20.2340],...
        [90,94.98,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Biotite', 'color', 'yellow');
       
    elseif (strcmp(phase, 'Calcite'))
       M = [[ 144.0  53.90  51.10  -20.5  0.000  0.000];...
            [ 53.90  144.0  51.10  20.50  0.000  0.000];...
            [ 51.10  51.10  84.00  0.000  0.000  0.000];...
            [ -20.5  20.50  0.000  33.50  0.000  0.000];...
            [ 0.000  0.000  0.000  0.000  33.50  -20.5];...
            [ 0.000  0.000  0.000  0.000  -20.5  33.50]];

       rho = 3.58;
       
       CS =  crystalSymmetry('-3m1', [ 4.99 4.99 17.064],...
        [90,90,120]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Calcite', 'color', 'light blue');
    
    elseif (strcmp(phase, 'Chlorite'))
        
       M = [[ 181.76	56.76	20.34	0       0       0];...
            [  56.76	181.76	20.34	0       0       0];...
            [  20.34	20.34	106.77	0       0       0];...
            [  0        0       0       11.41	0       0];...
            [  0        0       0       0       11.41	0];...
            [  0    	0       0       0       0       62.5]];

       rho = 2.69;
       
       CS = crystalSymmetry('12/m1', [5.35 9.267 14.27], ...
            [90,96.35,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
            'Chlorite', 'color', 'light green');
       
    elseif (strcmp(phase, 'Diopside'))
        M = [[204.0  84.40  81.00  0.000  17.00  0.000];...
             [84.40  175.0  57.00  0.000  07.00  0.000];...
             [81.00  57.00  238.0  0.000  43.00  0.000];...
             [0.000  0.000  0.000  67.50  0.000  07.30];...
             [17.00  07.00  43.00  0.000  58.80  0.000];...
             [0.000  0.000  0.000  07.30  0.000  70.50]];
         
       rho = 3.29;
       
       CS =  crystalSymmetry('12/m1', [9.746 8.99 5.251],...
        [90,90,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Diopside', 'color', 'green');
       
    elseif (strcmp(phase, 'Enstatite'))
        M = [[223.0  73.00  56.00  0.000  17.00  0.000];...
             [74.00  171.0  50.00  0.000  07.00  0.000];...
             [56.00  50.00  216.0  0.000  43.00  0.000];...
             [0.000  0.000  0.000  83.00  0.000  07.30];...
             [17.00  07.00  43.00  0.000  79.00  0.000];...
             [0.000  0.000  0.000  07.30  0.000  87.00]];
         
       rho = 3.198;
       
       CS =  crystalSymmetry('mmm', [18.227 8.819 5.179],...
        [90,90,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Enstatite', 'color', 'dark green');
    
     elseif (strcmp(phase, 'Epidote'))
        M = [[211.8	66.3	45.2	0       0       0];...
            [66.3	238.7	45.6	0       -8.2	0];...
            [45.2	45.6	202     0       -14.3	0];...
            [0      0       0       39.1	0       -3.4];...
            [0      -8.2	-14.3	0       43.2	0];...
            [0      0       0       -3.4	0       77.5]];
         
       rho = 3.4;
       
       CS =  crystalSymmetry('12/m1', [8.96 5.63 10.2], ...
            [90,115.4,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
            'Epidote', 'color', 'green');
    
    elseif (strcmp(phase, 'Forsterite'))
        M = [[329.1  66.30  68.40  0.000  0.000  0.000];...
             [66.30  200.5  72.80  0.000  0.000  0.000];...
             [68.40  72.80  236.3  0.000  0.000  0.000];...
             [0.000  0.000  0.000  67.23  0.000  0.000];...
             [0.000  0.000  0.000  0.000  81.44  0.000];...
             [0.000  0.000  0.000  0.000  0.000  81.14]];

        rho = 3.226;
        
        CS =  crystalSymmetry('2/m', [4.7540 10.1971 5.9806],...
        [90,105.63,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Forsterite', 'color', 'green');
    
    elseif (strcmp(phase, 'Hypersthene'))
        M = [[223.0  70.10  57.30  0.000  0.000  0.000];...
             [70.10  165.4  49.60  0.000  0.000  0.000];...
             [57.30  49.60  205.7  0.000  0.000  0.000];...
             [0.000  0.000  0.000  83.10  0.000  0.000];...
             [0.000  0.000  0.000  0.000  76.40  0.000];...
             [0.000  0.000  0.000  0.000  0.000  78.50]];
         
       rho = 3.38;
       
       CS =  crystalSymmetry('mmm', [18.2 8.86 5.22],...
        [90,90,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Hypersthene', 'color', 'green');

    elseif (strcmp(phase, 'Hornblende'))            
       M = [[116.0  44.90  61.40  0.000  04.30  0.000];...
            [44.90  159.7  65.50  0.000  -2.50  0.000];...
            [61.40  65.50  197.6  0.000  10.00  0.000];...
            [0.000  0.000  0.000  57.40  0.000  -6.20];...
            [04.30  -2.50  10.00  0.000  31.80  0.000];...
            [0.000  0.000  0.000  -6.20  0.000  36.80]];
        
       rho = 3.12;
       
       CS = crystalSymmetry('12/m1', [9.895 18.119 5.332],...
        [90,105.17,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Hornblende', 'color', 'dark green');
    
    elseif (strcmp(phase, 'Ilmenite'))            
       M = [[472	168     70      -27     24      0];...
            [168	472     70      27      -24     0];...
            [70     70      382     0       0       0];...
            [-27	27      0       106     0       -24];...
            [24     -24     0       0       106     -27];...
            [0      0       0       -24     -27     152]];
        
       rho = 3.79;
       
       CS = crystalSymmetry('-3', [5.08854 5.08854 14.0924], ...
           'X||a*', 'Y||b', 'Z||c', 'mineral', 'Ilmenite', 'color', 'dark red');
       
    elseif (strcmp(phase, 'KFeldspar'))
       M = [[ 62.50  42.80  35.80  0.000  -15.4  0.000];...
            [ 42.80  172.0  24.10  0.000  -14.3  0.000];...
            [ 35.80  24.10  124.4  0.000  -11.5  0.000];...
            [ 0.000  0.000  0.000  14.30  0.000  -2.80];...
            [ -15.4  -14.3  -11.5  0.000  22.30  0.000];...
            [ 0.000  0.000  0.000  -2.80  0.000  37.40]];
        
       rho = 2.56;  
       
       CS = crystalSymmetry('12/m1', [8.572 12.961 7.222],...
        [90,115.93,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'KFeldspar', 'color', 'cyan');
       
    elseif (strcmp(phase, 'Muscovite'))
       M = [[ 178.0  42.40  14.50  0.000  0.000  0.000];...
            [ 42.40  178.0  14.50  0.000  0.000  0.000];...
            [ 14.50  14.50  54.90  0.000  0.000  0.000];...
            [ 0.000  0.000  0.000  12.20  0.000  0.000];...
            [ 0.000  0.000  0.000  0.000  12.20  0.000];...
            [ 0.000  0.000  0.000  0.000  0.000  67.80]];

       rho = 2.79;
       
       CS =  crystalSymmetry('12/m1', [ 5.189 8.995 20.097],...
        [90,95.18,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Muscovite', 'color', 'light green');
    
    elseif (strcmp(phase, 'Pyrope'))
       M = [[ 296.2	111.1	111.1	0.000  0.000  0.000];...
            [ 111.1	296.2	111.1	0.000  0.000  0.000];...
            [ 111.1	111.1	296.2	0.000  0.000  0.000];...
            [ 0.000  0.000  0.000	91.60  0.000  0.000];...
            [ 0.000  0.000  0.000   0.000  91.60  0.000];...
            [ 0.000  0.000  0.000   0.000  0.000  91.60]];
        
       rho = 3.567;
       
       CS =  crystalSymmetry('m-3m', [11.531 11.531 11.531],...
            'mineral', 'Pyrope', 'color', 'magenta'); 
    
    elseif (strcmp(phase, 'Quartz'))
       M = [[ 86.80  07.04  11.91 -18.04  0.000  0.000];...
            [ 07.04  86.80  11.91  18.04  0.000  0.000];...
            [ 11.91  11.91 105.75  0.000  0.000  0.000];...
            [-18.04  18.04  0.000  58.20  0.000  0.000];...
            [ 0.000  0.000  0.000  0.000  58.20 -18.04];...
            [ 0.000  0.000  0.000  0.000 -18.04  39.88]];
        
       rho = 2.65;
       
       CS = crystalSymmetry('pointId', 18, [4.913 4.913 5.504],...
        [90,90,120]*degree,'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Quartz','color', 'red'); 
    % This should be pointId 18 but MTEX code and documentation does not
    % match
    
    elseif (strcmp(phase, 'Rutile'))
       M = [[269	177	146	0	0	0];...
            [177	269	146	0	0	0];...
            [146	146	480	0	0	0];...
            [0	0	0	124	0	0];...
            [0	0	0	0	124	0];...
            [0	0	0	0	0	192]];

       rho = 4.26;
       
        CS = crystalSymmetry('4/mmm', [4.594 4.594 2.958],...
            'mineral', 'Rutile', 'color', 'blue'); 
    
    elseif (strcmp(phase, 'Scapolite'))
       M = [[99.00   35.10   35.40   .0000   .0000   .0000];...
            [35.10   99.00   35.40   .0000   .0000   .0000];...
            [35.40   35.40  113.00   .0000   .0000   .0000];...
            [.0000   .0000   .0000   15.60   .0000   .0000];...
            [.0000   .0000   .0000   .0000   15.60   .0000];...
            [.0000   .0000   .0000   .0000   .0000   22.90]];
       
       rho = 2.65;
       
       CS = crystalSymmetry('4/m', [12.069 12.069 7.581],...
        'mineral', 'Scapolite', 'color', 'yellow');
       
    elseif (strcmp(phase, 'Sillimanite'))
       M = [[287.3  158.6  83.40  0.000  0.000  0.000];...
            [158.6  231.9  94.70  0.000  0.000  0.000];...
            [83.40  94.70  388.4  0.000  0.000  0.000];...
            [0.000  0.000  0.000  122.4  0.000  0.000];...
            [0.000  0.000  0.000  0.000  80.70  0.000];...
            [0.000  0.000  0.000  0.000  0.000  89.30]];

       rho = 3.24;
       
       CS =  crystalSymmetry('2/m', [7.798 7.9031 5.5566],...
        [90,90,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Sillimanite', 'color', 'light blue');
       
    elseif (strcmp(phase, 'Staurolite'))
       M = [[343.0  67.00  61.00  0.000  0.000  0.000];...
            [67.00  185.0  128.0  0.000  0.000  0.000];...
            [61.00  128.0  147.0  0.000  0.000  0.000];...
            [0.000  0.000  0.000  46.00  0.000  0.000];...
            [0.000  0.000  0.000  0.000  70.00  0.000];...
            [0.000  0.000  0.000  0.000  0.000  92.00]];

       rho = 3.79;
       
       CS =  crystalSymmetry('2/m', [7.871 16.620 5.656],...
        [90,90,90]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Staurolite', 'color', 'light blue');

    elseif (strcmp(phase, 'Tourmaline'))       
       M = [[ 305.0  108.0  51.00  -6.00  0.000  0.000];...
            [ 108.0  305.0  51.00  06.00  0.000  0.000];...
            [ 51.00  51.00  176.4  0.000  0.000  0.000];...
            [ -6.00  06.00  0.000  64.80  0.000  0.000];...
            [ 0.000  0.000  0.000  0.000  64.80  -6.00];...
            [ 0.000  0.000  0.000  0.000  -6.00  98.50]];

       rho = 2.96;
       
       CS = crystalSymmetry('-3', [15.992 15.992 7.19],...
        [90,90,120]*degree, 'X||a*', 'Y||b', 'Z||c', 'mineral',...
        'Tourmaline','color', 'blue');  
    
    elseif strendswith(phase, '_melt')

        M = [[ 16.10 	15.967	15.967	0.000	0.000	0.000];...
            [ 15.967	16.10	15.967	0.000	0.000	0.000];...
            [ 15.967	15.967	16.10	0.000	0.000	0.000];...
            [ 0.000     0.000	0.000	0.010	0.000	0.000];...
            [ 0.000     0.000	0.000	0.000	0.010	0.000];...
            [ 0.000     0.000	0.000	0.000	0.000	0.010]];  
			
        if (strcmp(phase, 'An38_melt'))
                rho = 2.39;
       
           elseif (strcmp(phase, 'An85_melt'))
                rho = 2.50;

           elseif (strcmp(phase, 'Quartz_melt'))
                rho = 2.25;

           elseif (strcmp(phase, 'KFeldspar_melt'))
                rho = 2.30;

           elseif (strcmp(phase, 'Scapolite_melt'))
                rho = 2.50;

           elseif (strcmp(phase, 'Augite_melt'))
                rho = 2.65;
           else
               rho = 2.43;
               %error('No density attributed to phase')
         end
           
           CS = crystalSymmetry('O');
    else
       M = 0;
       rho = 0;
       CS = 'notIndexed';
       
    end
    
end